# API/決済不要！Googleスプレッドシート自動翻訳・更新ツール (Google Sheets Auto-Translation & Update Tool - No API Key/Payment Required)

**➡️ [このスプレッドシートをコピーしてすぐに翻訳開始！](https://docs.google.com/spreadsheets/d/1iiGXb3FoQvdisdWWc9KplwzdHD07Ne1aYBnhvTI56ao/edit?usp=sharing)**

*Google Apps Scriptの知識やAPIキー設定は一切不要です。上記リンクからシートをコピーするだけで、どなたでも簡単に利用を開始できます。*

---

## 概要

当プロジェクトは、韓国本社のGoogleスプレッドシート資料を日本支社で円滑に活用するために開発された、Google Apps Scriptベースの自動翻訳・更新ツールです。**別途Google Cloud Translation APIキーや有料決済は不要**で、Googleスプレッドシート内蔵関数とApps Scriptのみで動作し、誰でも簡単に利用できるようにすることを目標としました。単純な翻訳だけでなく、元シートの書式、セル内画像などを最大限保持し、大量のタブも効率的に処理できるよう設計されています。ユーザーは「ワンクリック」で全シートを更新したり、特定のタブから希望の言語ペアで手動/自動更新したりすることが可能です。

## 背景・開発動機

私は現在、韓国に本社を置く企業の日本支社で勤務している社会人3年目の韓国人です。本社から共有されるGoogleスプレッドシート資料のほとんどは韓国語で作成されており、日本の現地社員が業務に活用するためには翻訳作業が不可欠でした。

単純な`IMPORTRANGE`と`GOOGLETRANSLATE`関数だけでは、以下のような問題点がありました：
*   元シートの重要な書式（色、フォント、日付/数値フォーマット、セル結合など）が維持されない。
*   セル内に挿入された画像が失われる。(現バージョンではハイパーリンクも失われる可能性があります。今後改善予定)
*   数十個のタブを一つ一つ翻訳/コピーするのに多くの時間と労力がかかる。
*   大量の`GOOGLETRANSLATE`関数同時呼び出しによる「ロード中...」エラー及びAPI割り当て超過問題の発生。

**開発目標の一つは「利用の容易さの最大化」でした。** もちろん、Google Cloud Translation APIを直接連携したり、Pythonなどで外部ツールを作成したりすれば、より強力で柔軟な翻訳システムを構築できますが、社内の同僚たちが少しでも複雑な設定や外部プログラムのインストールが必要になると活用度が下がると判断しました。そのため、**「Googleスプレッドシートファイルをコピーしてすぐに使える」簡単な方式**を採用し、誰でも容易にアクセスし活用できるようにすることに重点を置きました。

初期バージョンは簡単な手動実行方式でしたが、現地同僚からの貴重なフィードバックを反映し、ワンクリック全体/部分実行、自動更新、書式/画像保持など多様な機能を備えた現在の姿に発展しました。この機会に初めてGitHub、Qiita、Wantedlyなどのプラットフォームを活用し、私の成長過程とプロジェクトを共有したいと考えています。

---

## 主要機能

当自動翻訳・更新ツールは、以下の核心機能を提供し、韓国語元Googleスプレッドシートを日本語（または指定されたターゲット言語）バージョンとして効率的に管理できるよう支援します。

*   **1. 元シート情報自動読み込み及び翻訳タブ名生成:**
    *   管理シートの「R12」セルに入力された元GoogleスプレッドシートURLを基に、**非表示に設定されていない全タブ（シート）の名前を自動的に「C列」に出力**します。
    *   「R11」（ソース言語）及び「S11」（ターゲット言語）セルに設定された言語コードを基準に、**C列の元タブ名を`GOOGLETRANSLATE`関数を使い自動的に翻訳し、その結果を「D列」にタブ名として生成**します。（例：「커뮤니티」→「コミュニティ」）
    *   D列に生成されたタブ名が重複する場合、自動的に`_ (2)`、`_ (3)`などを付加し、固有のタブ名を保証します。

*   **2. 多様な実行モード提供:**
    *   **高速実行（「実行」ボタン）:**
        *   ユーザーが管理シート「H23」セルで開始タブを指定するか、空欄の場合は最初から**5分間（300秒）順次**タブを翻訳・更新します。
        *   5分の時間制限で作業が未完了の場合、最後に処理中だった一時ファイルを整理し、次回継続実行できるように「H23」セルに次の開始タブ名を自動的に記録します。（**未完了時は途中から再実行可能**）
        *   処理されたタブまでの部分的なシート並び替えが行われます。
    *   **低速実行（「低速実行」ボタン）:**
        *   各タブを個別トリガーで順次処理し、Google Apps Scriptの実行時間制限なしに全タブの翻訳・更新を保証します。（時間はかかりますが全シートを処理）
        *   大量のタブを安定して処理する場合に有効です。
    *   **毎日自動実行（5番機能）:**
        *   管理シート「R15」セルに指定した時間に「低速実行」モードで毎日自動的に全タブを更新します。H23に設定したタブとは関係なく全タブが処理されます。

*   **3. 柔軟な翻訳オプション（柔軟な翻訳オプション）:**
    *   **✅ 多言語対応:** 韓国語(KOR), 日本語(JPN), 英語(ENG), 中国語(CHN), 台湾語(TWN)間の翻訳をサポートします。管理シートで言語コードを選択するだけで、様々な言語ペアで翻訳を実行できます。
    *   **現在タブのみ即時更新:** Googleスプレッドシートメニューの「現在タブ更新」を通じて、現在アクティブなタブのみ指定した言語ペア（最大4つの組み合わせをカスタマイズ可能）で即時に翻訳・更新できます。
    *   管理シートの「R11/S11」、「R17/S17」、「R18/S18」、「R19/S19」セルで言語ペアを自由に設定し、シート再読み込み後にメニューに反映できます。
    *   **セル内画像及び書式保持:**
        *   翻訳過程で元シートのセル書式（背景色、フォント、罫線、数値/日付フォーマット、セル結合など）をそのまま維持します。
        *   セル内に挿入された画像がある場合、該当セルは翻訳せずにスキップし、画像が失われないように処理します。

*   **4. リアルタイム進行状況通知及びエラー処理:**
    *   管理シート「R16」セルに現在処理中のタブ名、開始時間、完了メッセージ、エラー内容などをリアルタイムで出力し、ユーザーが進行状況を容易に把握できるようにします。
    *   タブ処理時間が**7分以上経過した場合**（Google Apps Script無料版の場合、単一実行時間が6分に制限されているため、7分以上所要時はタイムアウトの可能性を通知）、該当タブから再実行するように案内メッセージを表示します。
    *   エラー発生時、該当タブのエラー内容をログに記録し、次のタブ処理を継続することで全体作業の中断を防ぎます。

*   **5. シート自動並び替え及び整理:**
    *   全ての翻訳/更新作業完了後、管理シート「D列」にリストされたタブ順序通りに実際のシートタブを自動的に並び替えます。
    *   D列リストにはあるが実際には生成されていないタブがあれば、空のタブを生成して順序を合わせます。
    *   D列リストにない不要なタブや作業中に生成された一時タブ（`_tmp`、`_format_tmp`）は自動的に削除し、シートをきれいに保ちます。（管理シート除く）

*   **6. ユーザーフレンドリーなUI及び案内:**
    *   「実行」または「低速実行」ボタンクリック前に確認ポップアップを表示し、ユーザーのミスを防ぎます。
    *   管理シート内に詳細な「使い方」及び「注意事項」を日本語で提供し、日本人ユーザーの利便性を高めました。

---

## 使い方

当ツールを使用するための基本的な手順は以下の通りです。詳細は管理シート内の「使い方」タブを参照してください。

1.  **コピーを作成:**
    *   提供されたGoogleスプレッドシートのリンクを開き、「ファイル」>「コピーを作成」を通じてご自身のGoogleドライブにコピーします。
2.  **管理シート設定:**
    *   コピーされたシートの「管理」タブを開きます。
    *   **1番領域（R12セル）:** 翻訳したい元のGoogleスプレッドシートの完全なURLを入力します。
    *   **3番領域（R11, S11セル）:** 基本の翻訳言語ペアを設定します。（例: KOR → JPN）
    *   **(任意) H23セル:** 「実行」ボタンで特定のタブから開始したい場合、該当タブの名前をD列から探して入力します。（空欄の場合は最初から実行）
3.  **初回権限承認:**
    *   **「実行」または「低速実行」ボタンを初めてクリック**するか、メニューから「現在タブ更新」を初めて実行すると、権限承認要求ポップアップが表示されます。
    *   案内に従い「確認」→アカウント選択→「詳細」または「詳細設定」→「（プロジェクト名）に移動（安全ではありません）」→「許可」をクリックします。（初回1回のみ必要）
4.  **実行:**
    *   「管理」シートの**「実行」ボタン（5分制限、部分実行可能）**または**「低速実行」ボタン（時間制限なし、全シート処理保証）**をクリックして翻訳/更新を開始します。
    *   メニューの「現在タブ更新」を通じて、現在アクティブなタブのみ個別に更新することも可能です。
5.  **進行状況確認:**
    *   「R16」セルにリアルタイムの進行状況及び完了/エラーメッセージが表示されます。

---

## 今後の改善点

*   **ハイパーリンク保持:** 現バージョンでは、翻訳処理の過程で**セル内のハイパーリンクは失われます。**

---

## 作成者

HONG SEONGGEON
[https://github.com/HNGSNGGN/](https://github.com/HNGSNGGN/)

---
